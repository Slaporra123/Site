<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>💖 O Amor da Minha Vida 💖</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            min-height: 100vh;
            background: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        h1 {
            color: #ff1493;
            font-size: 2.5em;
            text-shadow: 0 0 15px #ff1493;
            margin-bottom: 10px;
            text-align: center;
        }

        .gallery {
            display: flex;
            gap: 20px;
            max-width: 800px;
            width: 100%;
            justify-content: center;
            margin-bottom: 20px;
        }

        .media-container {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(255, 20, 147, 0.3);
            transition: transform 0.3s ease;
            background: #333;
            width: 150px;
            height: 150px;
            cursor: pointer;
        }

        .media-container:hover {
            transform: scale(1.03);
        }

        .media {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .contador {
            color: #ff1493;
            text-align: center;
            font-size: 1.2em;
            margin-top: 20px;
        }

        .contador p {
            margin: 5px 0;
        }

        .secret-layer {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            align-items: center;
            justify-content: center;
            color: #ff1493;
            text-align: center;
            font-size: 1.2em;
            flex-direction: column;
            gap: 20px;
        }

        .secret-layer.active {
            display: flex;
        }

        .secret-message {
            font-size: 1.5em;
            margin-bottom: 30px;
            color: #ff1493;
            text-shadow: 0 0 15px #ff1493;
            max-width: 80%;
            line-height: 1.5;
        }

        .back-button {
            padding: 12px 25px;
            font-size: 1em;
            background: #ff1493;
            color: #fff;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .back-button:hover {
            background: #ff0066;
            transform: scale(1.05);
        }

        .heart, .balloon {
            position: absolute;
            font-size: 1.5em;
            user-select: none;
            pointer-events: none;
            animation: float 6s ease-in infinite;
        }

        .heart { color: #ff1493; }
        .balloon { color: #fff; }

        @keyframes float {
            0% { transform: translateY(110vh) translateX(-50%); }
            100% { transform: translateY(-10vh) translateX(50%); }
        }

        @media (min-width: 768px) {
            .media-container { width: 200px; height: 200px; }
            h1 { font-size: 3em; }
            .contador { font-size: 1.5em; }
            .secret-message { font-size: 1.8em; }
        }

        @media (min-width: 1024px) {
            .media-container { width: 250px; height: 250px; }
        }

        .anniversary-message {
            display: none;
            color: #ff1493;
            text-align: center;
            font-size: 1.5em;
            margin-top: 20px;
            text-shadow: 0 0 15px #ff1493;
        }

        .anniversary-message.active { display: block; }
        .contador.hidden { display: none; }

        .minigames-menu {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 20, 147, 0.5);
            z-index: 1000;
            text-align: center;
        }

        .minigames-menu.active { display: block; }

        .minigames-menu button {
            padding: 10px 20px;
            font-size: 1em;
            background: #ff1493;
            color: #fff;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }

        .minigames-menu button:hover {
            background: #ff0066;
            transform: scale(1.05);
        }

        .puzzle-layer {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            align-items: center;
            justify-content: center;
            color: #ff1493;
            text-align: center;
            font-size: 1.2em;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .puzzle-layer.active { display: flex; }

        #difficulty-selector {
            margin-bottom: 10px;
            color: #ff1493;
            text-shadow: 0 0 5px #ff1493;
        }

        #difficulty-selector label {
            margin-right: 10px;
        }

        #difficulty {
            padding: 5px;
            background: #333;
            color: #ff1493;
            border: 1px solid #ff1493;
            border-radius: 5px;
        }

        #guide-image {
            max-width: 90vw;
            max-height: 15vh;
            margin-bottom: 10px;
            border: 2px solid #ff1493;
        }

        #puzzle-container {
            display: grid;
            gap: 5px;
            margin-bottom: 10px;
            width: 90vw;
            height: calc(100vh - 250px);
            max-width: 600px;
            max-height: 600px;
        }

        .puzzle-piece {
            border: 1px solid #ff1493;
            box-sizing: border-box;
            overflow: hidden;
            position: relative;
            transition: transform 0.3s ease;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            color: #ff1493;
        }

        .puzzle-piece img {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .empty {
            background: #333;
            border: 2px dashed #ff1493;
            cursor: not-allowed;
        }

        .locked {
            cursor: not-allowed;
            pointer-events: none;
        }

        #message {
            text-align: center;
            font-size: 1.2em;
            color: #ff1493;
            text-shadow: 0 0 5px #ff1493;
        }

        #counters {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 400px;
            margin-bottom: 10px;
            font-size: 1.2em;
            color: #ff1493;
            text-shadow: 0 0 5px #ff1493;
        }

        .puzzle-buttons {
            display: flex;
            gap: 10px;
        }

        .puzzle-buttons button, #start-button, #custom-image-button {
            padding: 10px 20px;
            font-size: 1em;
            background: #ff1493;
            color: #fff;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .puzzle-buttons button:hover, #start-button:hover, #custom-image-button:hover {
            background: #ff0066;
            transform: scale(1.05);
        }

        .puzzle-buttons button.hidden { display: none; }
    </style>
</head>
<body>
    <h1>💖 O Amor da Minha Vida 💖</h1>

    <div class="gallery">
        <div class="media-container" data-code="•"><div id="media1" class="media"></div></div>
        <div class="media-container" data-code="-"><div id="media2" class="media"></div></div>
    </div>

    <div class="contador" id="contador">
        <p id="tempoConhecemos"></p>
        <p id="tempoNamoro"></p>
    </div>

    <div class="anniversary-message" id="anniversaryMessage"></div>

    <div class="secret-layer" id="secretLayer">
        <div class="secret-message">
            Eu amo MUITO te ter na minha vida,<br>
            amo te amar e prometo te fazer<br>
            a mulher mais feliz do mundo<br>
            enquanto a gente ainda respirar <span id="heartClick" style="cursor: pointer;">💘</span>
        </div>
        <button class="back-button" onclick="hideSecretLayer()">Voltar</button>
    </div>

    <div class="minigames-menu" id="minigamesMenu">
        <h2 style="color: #ff1493; text-shadow: 0 0 5px #ff1493;">Minigames</h2>
        <button onclick="startPuzzle()">Quebra-Cabeça</button>
    </div>

    <div class="puzzle-layer" id="puzzleLayer">
        <div id="difficulty-selector">
            <label for="difficulty">Escolha a dificuldade:</label>
            <select id="difficulty">
                <option value="3">Fácil (3x3)</option>
                <option value="4">Médio (4x4)</option>
                <option value="5">Difícil (5x5)</option>
            </select>
            <button id="start-button">Iniciar Jogo</button>
        </div>
        <input type="file" id="file-input" accept="image/*" style="display: none;">
        <button id="custom-image-button">Usar Minha Imagem</button>
        <img id="guide-image" src="" alt="Guia do Quebra-Cabeça">
        <div id="counters">
            <div>Tempo: <span id="time-counter">00:00</span></div>
            <div>Movimentos: <span id="move-counter">0</span></div>
        </div>
        <div id="puzzle-container"></div>
        <div id="message">Escolha a dificuldade e clique em "Iniciar Jogo".</div>
        <div class="puzzle-buttons">
            <button onclick="hidePuzzleLayer()">Voltar à Tela Inicial</button>
            <button id="replayButton" class="hidden" onclick="restartPuzzle()">Rejogar</button>
        </div>
    </div>

    <div id="particles-js"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.34/moment-timezone-with-data.min.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        particlesJS("particles-js", {
            particles: {
                number: { value: 50, density: { enable: true, value_area: 800 } },
                color: { value: "#ff1493" },
                shape: { type: "circle", stroke: { width: 0, color: "#000000" }, polygon: { nb_sides: 5 } },
                opacity: { value: 0.5, random: false, anim: { enable: false, speed: 1, opacity_min: 0.1, sync: false } },
                size: { value: 3, random: true, anim: { enable: false, speed: 40, size_min: 0.1, sync: false } },
                line_linked: { enable: true, distance: 150, color: "#ff1493", opacity: 0.4, width: 1 },
                move: { enable: true, speed: 6, direction: "none", random: false, straight: false, out_mode: "out", bounce: false, attract: { enable: false, rotateX: 600, rotateY: 1200 } }
            },
            interactivity: {
                detect_on: "canvas",
                events: { onhover: { enable: false, mode: "repulse" }, onclick: { enable: false, mode: "push" }, resize: true },
                modes: { grab: { distance: 400, line_linked: { opacity: 1 } }, bubble: { distance: 400, size: 40, duration: 2, opacity: 8, speed: 3 }, repulse: { distance: 200, duration: 0.4 }, push: { particles_nb: 0 }, remove: { particles_nb: 2 } }
            },
            retina_detect: true
        });

        const token = [
            String.fromCharCode(103), "h", "p", "_", "e", "3", "x", "7", "9", String.fromCharCode(77),
            "5", String.fromCharCode(68), String.fromCharCode(87), String.fromCharCode(79), String.fromCharCode(84),
            "p", String.fromCharCode(86), String.fromCharCode(78), String.fromCharCode(81), "o", "o",
            String.fromCharCode(76), String.fromCharCode(89), String.fromCharCode(66), String.fromCharCode(66),
            "e", String.fromCharCode(90), String.fromCharCode(76), String.fromCharCode(71), "w", "k",
            String.fromCharCode(74), "b", "9", "4", "c", "9", "a", "6", String.fromCharCode(87)
        ].join("");

        const config = {
            usuario: 'Slaporra123',
            repositorio: 'Site',
            branch: 'main',
            pasta: 'Fotos',
            token: token
        };

        let displayedMedia = new Set();

        async function carregarMidias() {
            try {
                const apiUrl = `https://api.github.com/repos/${config.usuario}/${config.repositorio}/contents/${config.pasta}?ref=${config.branch}`;
                const response = await fetch(apiUrl, {
                    headers: { 'Authorization': `token ${config.token}`, 'Accept': 'application/vnd.github.v3+json' }
                });
                if (!response.ok) throw new Error(`Erro HTTP: ${response.status} - ${response.statusText}`);
                const files = await response.json();
                const midias = files
                    .filter(file => /\.(jpg|jpeg|png|gif|webp|mp4|webm)$/i.test(file.name))
                    .map(file => ({ url: file.download_url, type: file.name.match(/\.(jpg|jpeg|png|gif|webp|mp4|webm)$/i)[1].toLowerCase() }));

                if (midias.length < 2) throw new Error('Adicione pelo menos 2 mídias diferentes');
                const availableMedia = midias.filter(media => !displayedMedia.has(media.url));
                if (availableMedia.length < 2) {
                    displayedMedia.clear();
                    return carregarMidias();
                }

                const shuffled = availableMedia.sort(() => Math.random() - 0.5);
                const [media1, media2] = shuffled.slice(0, 2);

                exibirMidia(document.getElementById('media1'), media1);
                exibirMidia(document.getElementById('media2'), media2);

                displayedMedia.add(media1.url);
                displayedMedia.add(media2.url);
            } catch (error) {
                console.error('Erro ao carregar mídias:', error);
                alert(`Falha ao carregar: ${error.message}`);
            }
        }

        function exibirMidia(container, media) {
            container.innerHTML = '';
            if (media.type === 'mp4' || media.type === 'webm') {
                const video = document.createElement('video');
                video.src = media.url;
                video.autoplay = true;
                video.loop = true;
                video.muted = true;
                video.classList.add('media');
                container.appendChild(video);
            } else {
                const img = document.createElement('img');
                img.src = media.url;
                img.alt = 'Mídia';
                img.classList.add('media');
                container.appendChild(img);
            }
        }

        const secretCode = ['•', '•', '-'];
        let inputSequence = [];

        function checkSecretCode() {
            if (inputSequence.length > secretCode.length) inputSequence.shift();
            if (inputSequence.join('') === secretCode.join('')) {
                showSecretLayer();
                inputSequence = [];
            }
        }

        function showSecretLayer() {
            document.getElementById('secretLayer').classList.add('active');
        }

        function hideSecretLayer() {
            document.getElementById('secretLayer').classList.remove('active');
        }

        const dataConhecemos = moment.tz("2024-07-11 16:24", "YYYY-MM-DD HH:mm", "America/Sao_Paulo");
        const dataNamoro = moment.tz("2024-07-26 23:30", "YYYY-MM-DD HH:mm", "America/Sao_Paulo");

        function calcularDiferenca(dataInicial) {
            const agora = moment.tz("America/Sao_Paulo");
            const anos = agora.diff(dataInicial, 'years');
            dataInicial.add(anos, 'years');
            const meses = agora.diff(dataInicial, 'months');
            dataInicial.add(meses, 'months');
            const dias = agora.diff(dataInicial, 'days');
            dataInicial.add(dias, 'days');
            const horas = agora.diff(dataInicial, 'hours');
            dataInicial.add(horas, 'hours');
            const minutos = agora.diff(dataInicial, 'minutes');
            dataInicial.add(minutos, 'minutes');
            const segundos = agora.diff(dataInicial, 'seconds');
            return { anos, meses, dias, horas, minutos, segundos };
        }

        function formatarTempo(tempo) {
            return `${tempo.anos} anos, ${tempo.meses} meses, ${tempo.dias} dias, ${tempo.horas} horas, ${tempo.minutos} minutos e ${tempo.segundos} segundos`;
        }

        function atualizarContador() {
            const tempoConhecemos = calcularDiferenca(moment(dataConhecemos));
            const tempoNamoro = calcularDiferenca(moment(dataNamoro));
            document.getElementById('tempoConhecemos').textContent = `Fazem exatamente ${formatarTempo(tempoConhecemos)} que eu conheci o amor da minha vida.`;
            document.getElementById('tempoNamoro').textContent = `${formatarTempo(tempoNamoro)} que eu finalmente ganhei o coração dela e começamos a escrever nossa história.`;
        }

        function criarFesta() {
            const emojisCoracao = ['💖', '💕', '💞', '💓', '💗'];
            const emojisBalao = ['🎈', '🎈', '🎈', '🎈', '🎈'];
            document.querySelectorAll('.heart, .balloon').forEach(el => el.remove());

            for (let i = 0; i < 10; i++) {
                const coracao = document.createElement('div');
                coracao.classList.add('heart');
                coracao.textContent = emojisCoracao[Math.floor(Math.random() * emojisCoracao.length)];
                coracao.style.left = `${Math.random() * 100}vw`;
                coracao.style.animationDuration = `${Math.random() * 4 + 3}s`;
                document.body.appendChild(coracao);

                const balao = document.createElement('div');
                balao.classList.add('balloon');
                balao.textContent = emojisBalao[Math.floor(Math.random() * emojisBalao.length)];
                balao.style.left = `${Math.random() * 100}vw`;
                balao.style.animationDuration = `${Math.random() * 4 + 3}s`;
                document.body.appendChild(balao);
            }

            const tempoNamoro = calcularDiferenca(dataNamoro);
            let mesesArredondados = tempoNamoro.meses + 1;
            let mensagem = 'Feliz ';
            if (tempoNamoro.anos > 0) mensagem += `${tempoNamoro.anos} ano${tempoNamoro.anos > 1 ? 's' : ''} `;
            if (mesesArredondados > 0 && mesesArredondados < 12) mensagem += `${mesesArredondados} mês${mesesArredondados > 1 ? 'es' : ''} `;
            mensagem += 'de namoro, minha vampirinha 🧛‍♀️🦇🖤';

            const anniversaryMessage = document.getElementById('anniversaryMessage');
            anniversaryMessage.textContent = mensagem;
            anniversaryMessage.classList.add('active');
            document.getElementById('contador').classList.add('hidden');
        }

        function verificarAniversario() {
            const hoje = moment.tz("America/Sao_Paulo");
            const horaAtual = hoje.hours();
            const minutosAtuais = hoje.minutes();
            if (hoje.date() === 26) {
                if (horaAtual < 23 || (horaAtual === 23 && minutosAtuais <= 30)) {
                    criarFesta();
                } else {
                    document.getElementById('anniversaryMessage').classList.remove('active');
                    document.getElementById('contador').classList.remove('hidden');
                    document.querySelectorAll('.heart, .balloon').forEach(el => el.remove());
                }
            }
        }

        setInterval(() => {
            atualizarContador();
            verificarAniversario();
        }, 60000);

        carregarMidias().then(() => {
            atualizarContador();
            verificarAniversario();
        });

        document.querySelectorAll('.media-container').forEach(container => {
            container.addEventListener('click', () => {
                inputSequence.push(container.dataset.code);
                checkSecretCode();
            });
        });

        document.getElementById('heartClick').addEventListener('click', () => {
            document.getElementById('minigamesMenu').classList.add('active');
        });

        function startPuzzle() {
            document.getElementById('minigamesMenu').classList.remove('active');
            document.getElementById('puzzleLayer').classList.add('active');
        }

        function hidePuzzleLayer() {
            document.getElementById('puzzleLayer').classList.remove('active');
            stopTimer();
        }

        function restartPuzzle() {
            loadPuzzle();
        }

        const difficultySelector = document.getElementById('difficulty');
        const startButton = document.getElementById('start-button');
        const fileInput = document.getElementById('file-input');
        const customImageButton = document.getElementById('custom-image-button');
        const guideImage = document.getElementById('guide-image');
        const puzzleContainer = document.getElementById('puzzle-container');
        const message = document.getElementById('message');
        const timeCounter = document.getElementById('time-counter');
        const moveCounter = document.getElementById('move-counter');

        let pieces = [];
        let emptyIndex;
        let isGameOver = false;
        let gridSize = 3;
        let customImage = null;
        let moveCount = 0;
        let timeCount = 0;
        let timerInterval = null;
        let hasStarted = false;

        function createPuzzle(image) {
            pieces = [];
            puzzleContainer.innerHTML = '';
            puzzleContainer.style.gridTemplateColumns = `repeat(${gridSize}, 1fr)`;
            puzzleContainer.style.gridTemplateRows = `repeat(${gridSize}, 1fr)`;

            guideImage.src = image.src;

            const totalPieces = gridSize * gridSize;
            const numbers = Array.from({ length: totalPieces }, (_, i) => i + 1);
            emptyIndex = totalPieces - 1;

            for (let i = 0; i < totalPieces; i++) {
                const piece = document.createElement('div');
                piece.className = 'puzzle-piece' + (i === emptyIndex ? ' empty' : '');

                if (i !== emptyIndex) {
                    const img = document.createElement('img');
                    img.src = image.src;
                    img.style.width = `${gridSize * 100}%`;
                    img.style.height = `${gridSize * 100}%`;
                    img.style.left = `-${(i % gridSize) * 100}%`;
                    img.style.top = `-${Math.floor(i / gridSize) * 100}%`;
                    piece.appendChild(img);

                    const number = document.createElement('div');
                    number.textContent = numbers[i];
                    piece.appendChild(number);
                }

                pieces.push(piece);
                puzzleContainer.appendChild(piece);
            }

            puzzleContainer.addEventListener('click', (e) => {
                if (isGameOver) return;
                const clickedPiece = e.target.closest('.puzzle-piece');
                if (!clickedPiece || clickedPiece.classList.contains('empty')) return;

                const clickedIndex = pieces.indexOf(clickedPiece);
                if (getAdjacentIndices(clickedIndex).includes(emptyIndex)) {
                    swapPieces(clickedIndex, emptyIndex);
                    emptyIndex = clickedIndex;
                    moveCount++;
                    moveCounter.textContent = moveCount;

                    if (!hasStarted) {
                        hasStarted = true;
                        startTimer();
                    }

                    checkWin();
                }
            });
        }

        function getAdjacentIndices(index) {
            const adjacent = [];
            const row = Math.floor(index / gridSize);
            const col = index % gridSize;

            if (row > 0) adjacent.push(index - gridSize);
            if (row < gridSize - 1) adjacent.push(index + gridSize);
            if (col > 0) adjacent.push(index - 1);
            if (col < gridSize - 1) adjacent.push(index + 1);

            return adjacent;
        }

        function swapPieces(index1, index2) {
            const tempHTML = pieces[index1].innerHTML;
            pieces[index1].innerHTML = pieces[index2].innerHTML;
            pieces[index2].innerHTML = tempHTML;

            pieces[index1].classList.toggle('empty');
            pieces[index2].classList.toggle('empty');
        }

        function checkWin() {
            const totalPieces = gridSize * gridSize;
            const numbers = Array.from({ length: totalPieces }, (_, i) => i + 1);
            const isWin = pieces.every((piece, index) => {
                if (index === emptyIndex) return true;
                const number = piece.querySelector('div');
                return number && number.textContent == numbers[index];
            });

            if (isWin) {
                const emptyPiece = pieces[emptyIndex];
                const img = document.createElement('img');
                img.src = pieces[0].querySelector('img').src;
                img.style.width = `${gridSize * 100}%`;
                img.style.height = `${gridSize * 100}%`;
                img.style.left = `-${(emptyIndex % gridSize) * 100}%`;
                img.style.top = `-${Math.floor(emptyIndex / gridSize) * 100}%`;
                emptyPiece.innerHTML = '';
                emptyPiece.appendChild(img);
                emptyPiece.classList.remove('empty');

                message.textContent = 'Parabéns! Você venceu! 🎉';
                isGameOver = true;
                pieces.forEach(piece => piece.classList.add('locked'));
                document.getElementById('replayButton').classList.remove('hidden');
                stopTimer();
            }
        }

        function shufflePieces() {
            let shuffleSteps = 100 * gridSize;
            const shuffleInterval = setInterval(() => {
                if (shuffleSteps <= 0) {
                    clearInterval(shuffleInterval);
                    message.textContent = 'Clique nas peças para movê-las!';
                    return;
                }

                const adjacent = getAdjacentIndices(emptyIndex);
                const randomIndex = adjacent[Math.floor(Math.random() * adjacent.length)];
                swapPieces(randomIndex, emptyIndex);
                emptyIndex = randomIndex;
                shuffleSteps--;
            }, 5);
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeCount++;
                const minutes = Math.floor(timeCount / 60).toString().padStart(2, '0');
                const seconds = (timeCount % 60).toString().padStart(2, '0');
                timeCounter.textContent = `${minutes}:${seconds}`;
            }, 1000);
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        function startGameWithCustomImage(image) {
            isGameOver = false;
            hasStarted = false;
            moveCount = 0;
            timeCount = 0;
            moveCounter.textContent = moveCount;
            timeCounter.textContent = '00:00';
            gridSize = parseInt(difficultySelector.value);
            message.textContent = 'Carregando quebra-cabeça...';

            createPuzzle(image);
            shufflePieces();
        }

        customImageButton.addEventListener('click', () => {
            console.log("Tentando abrir seletor de arquivos...");
            if (fileInput && typeof fileInput.click === 'function') {
                fileInput.click(); // Dispara o seletor de arquivos
            } else {
                console.error("fileInput.click não é uma função ou elemento não encontrado.");
                alert("Seu dispositivo pode não suportar esse recurso. Tente outro navegador ou dispositivo.");
            }
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                console.log("Arquivo selecionado:", file.name);
                const reader = new FileReader();
                reader.onload = (event) => {
                    console.log("Carregando imagem...");
                    const image = new Image();
                    image.src = event.target.result;
                    image.onload = () => {
                        console.log("Imagem carregada com sucesso!");
                        customImage = image;
                        startGameWithCustomImage(image);
                    };
                    image.onerror = () => {
                        console.error("Erro ao carregar a imagem personalizada.");
                        message.textContent = 'Erro ao carregar a imagem personalizada.';
                    };
                };
                reader.readAsDataURL(file);
            } else {
                console.log("Nenhum arquivo selecionado.");
            }
        });

        async function fetchImages() {
            try {
                console.log("Buscando imagens no GitHub...");
                const apiUrl = `https://api.github.com/repos/${config.usuario}/${config.repositorio}/contents/${config.pasta}?ref=${config.branch}`;
                const response = await fetch(apiUrl, {
                    headers: { 'Authorization': `token ${config.token}`, 'Accept': 'application/vnd.github.v3+json' }
                });
                if (!response.ok) throw new Error(`Erro HTTP: ${response.status} - ${response.statusText}`);
                const data = await response.json();
                console.log("Resposta da API:", data);
                const imageFiles = data.filter(file => 
                    file.type === 'file' && file.name.match(/\.(jpg|jpeg|png|gif)$/i)
                );
                if (imageFiles.length === 0) throw new Error('Nenhuma imagem encontrada na pasta Fotos.');
                return imageFiles.map(file => file.download_url);
            } catch (error) {
                console.error("Erro ao buscar imagens:", error);
                message.textContent = `Erro ao carregar imagens: ${error.message}`;
                return [];
            }
        }

        function loadPuzzle() {
            isGameOver = false;
            hasStarted = false;
            moveCount = 0;
            timeCount = 0;
            moveCounter.textContent = moveCount;
            timeCounter.textContent = '00:00';
            gridSize = parseInt(difficultySelector.value);
            message.textContent = 'Carregando quebra-cabeça...';

            const puzzleSize = Math.min(90 * window.innerWidth / 100, 600);
            puzzleContainer.style.width = `${puzzleSize}px`;
            puzzleContainer.style.height = `${puzzleSize}px`;

            fetchImages().then(imageUrls => {
                if (imageUrls.length > 0) {
                    console.log("Imagens disponíveis:", imageUrls);
                    const image = new Image();
                    image.src = imageUrls[Math.floor(Math.random() * imageUrls.length)];
                    image.onload = () => {
                        console.log("Imagem carregada do GitHub:", image.src);
                        createPuzzle(image);
                        shufflePieces();
                    };
                    image.onerror = () => {
                        console.error("Erro ao carregar imagem do GitHub:", image.src);
                        message.textContent = 'Erro ao carregar a imagem do GitHub.';
                    };
                } else {
                    message.textContent = 'Nenhuma imagem encontrada na pasta Fotos.';
                }
            });
        }

        startButton.addEventListener('click', loadPuzzle);
    </script>
</body>
</html>
